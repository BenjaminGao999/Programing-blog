分布式锁必须要满足的条件：
1. 加锁和解锁操作必须是原子性的
2. 互斥锁
3. 加锁的client或线程挂了，锁必须被释放掉
4. 保证高可用性,避免单节点问题
5. 多节点保证加锁和释放锁的一致性
6. 公平锁的实现
7. 还要考虑锁的性能问题
8.可重入锁


http://zhangtielei.com/posts/blog-redlock-reasoning.html



Zookeeper/Redis高可用集群
主从架构
 主节点写， 从节点复制主节点， 当主节点下线由从节点升级为主节点。
  这种架构牺牲了 加锁/解锁的性能， 但是保证了加锁/解锁的一致性和分布式锁的高可用性。
  
  加锁的client/线程下线，必须触发自动解锁；
  
  
# MySQL分布式锁
 借助事务的特性和回滚机制、超时连接事务失败并回滚，实现MySQL自动释放由下线的客户端添加的锁。
 
 1. 锁粒度
  锁住某个共享资源、 锁住某个操作、 锁住某个方法、 全局锁（所有用户中只能一个获取锁）、 用户锁（用户级别的锁）

 根据业务可以划分多种锁粒度


